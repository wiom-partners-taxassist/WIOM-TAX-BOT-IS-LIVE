<!doctype html>
<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>WIOM Tax Help (smart intent)</title>
<style>
 body{font-family:Arial,system-ui,Segoe UI,Roboto; margin:0}
 #b{position:fixed;right:16px;bottom:16px;background:#2563eb;color:#fff;border-radius:50%;width:56px;height:56px;display:flex;align-items:center;justify-content:center;cursor:pointer}
 #w{position:fixed;right:16px;bottom:84px;width:440px;max-width:96vw;background:#fff;border:1px solid #ddd;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,.2);display:none;flex-direction:column}
 .h{background:#2563eb;color:#fff;padding:10px;border-top-left-radius:12px;border-top-right-radius:12px;display:flex;gap:8px;align-items:center}
 .h select{margin-left:auto}
 .m{height:460px;overflow:auto;padding:10px;background:#f8fafc}
 .i{display:flex;gap:6px;padding:10px;background:#fff;border-top:1px solid #eee}
 .i input{flex:1;padding:8px;border:1px solid #ddd;border-radius:8px}
 .i button{background:#2563eb;color:#fff;border:none;border-radius:8px;padding:8px 12px}
 .msg{margin:6px 0}.bot{background:#fff;border:1px solid #eee}.user{background:#eaf1ff}.bub{display:inline-block;padding:8px 10px;border-radius:10px;max-width:94%}
 .sug{display:flex;flex-wrap:wrap;gap:6px;padding:8px}.chip{border:1px solid #ddd;border-radius:999px;padding:6px 10px;font-size:12px;cursor:pointer;background:#fff}
 a{color:#2563eb}
</style>
</head>
<body>
<div id="b">üí¨</div>
<div id="w">
  <div class="h">WIOM Tax Help
    <select id="lang">
      <option value="en">EN</option><option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option><option value="hn">Hinglish</option>
    </select>
    <button id="x" style="background:transparent;border:none;color:#fff;font-size:16px">‚úñ</button>
  </div>
  <div id="m" class="m"></div>
  <div class="i"><input id="t" placeholder="Ask / ‡§™‡•Ç‡§õ‡•á‡§Ç / Pooche‚Ä¶"><button id="s">Send</button></div>
</div>

<script>
const it = 'https://www.incometax.gov.in/iec/foportal/';
const it_link_status = 'https://eportal.incometax.gov.in/iec/foservices/#/pre-login/bl-link-aadhaar';
const gst = 'https://services.gst.gov.in/services/searchtpbypan';

const A = {
  // Existing answers (shortened for clarity, kept as in your file)
  tds_en: `When WIOM gives you payout, some small tax (TDS) is cut as per government rule. This tax is cut under Section 194O.<br>
  First, your total earning is divided by 1.18 to find taxable income. Then TDS is charged.<br><br>
  <b>If your PAN is operative (linked with Aadhaar)</b><br>
  Example ‚Äì You earned ‚Çπ50,000<br>
  Step 1: ‚Çπ50,000 √∑ 1.18 = ‚Çπ42,373 (taxable income)<br>
  Step 2: TDS @0.1% = ‚Çπ42,373 √ó 0.1% = ‚Çπ42 (‚Äì)<br>
  So from ‚Çπ50,000, only ‚Çπ42 will be cut, you get around ‚Çπ49,958 (+)<br><br>
  <b>If your PAN is inoperative (NOT linked with Aadhaar)</b><br>
  Example ‚Äì You earned ‚Çπ50,000<br>
  Step 1: ‚Çπ50,000 √∑ 1.18 = ‚Çπ42,373 (taxable income)<br>
  Step 2: TDS @5% = ‚Çπ42,373 √ó 5% = ‚Çπ2,119 (‚Äì)<br>
  So from ‚Çπ50,000, ‚Çπ2,119 will be cut, you get only ‚Çπ47,881 (+)<br><br>
  <i>Whatever TDS is deducted will also appear in Form 16A (TDS Certificate).</i>`,
  tds_hi: `‡§ú‡§¨ WIOM payout ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§®‡§ø‡§Ø‡§Æ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ TDS ‡§≤‡§ó‡§§‡§æ ‡§π‡•à (‡§ß‡§æ‡§∞‡§æ 194O)‡•§ ‡§™‡§π‡§≤‡•á earning ‡§ï‡•ã 1.18 ‡§∏‡•á ‡§≠‡§æ‡§ó ‡§¶‡•á‡§ï‡§∞ taxable income ‡§®‡§ø‡§ï‡§æ‡§≤‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à, ‡§´‡§ø‡§∞ TDS‡•§<br><br>
  <b>PAN ‡§ë‡§™‡§∞‡•á‡§ü‡§ø‡§µ</b>: ‚Çπ50,000 √∑ 1.18 = ‚Çπ42,373 ‚Üí 0.1% = ‚Çπ42 ‡§ï‡§ü‡•á‡§ó‡§æ ‚Üí ‡§≤‡§ó‡§≠‡§ó ‚Çπ49,958 ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ‡•§<br>
  <b>PAN ‡§®‡•â‡§®-‡§ë‡§™‡§∞‡•á‡§ü‡§ø‡§µ</b>: ‡§µ‡§π‡•Ä income ‡§™‡§∞ 5% = ‚Çπ2,119 ‡§ï‡§ü‡•á‡§ó‡§æ ‚Üí ‡§≤‡§ó‡§≠‡§ó ‚Çπ47,881 ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ‡•§<br><i>‡§ï‡§ü‡•å‡§§‡•Ä Form 16A ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ñ‡•á‡§ó‡•Ä‡•§</i>`,
  tds_hn: `WIOM payout par Section 194O ke hisaab se TDS lagta hai. Pehle earning/1.18 = taxable income. PAN operative par 0.1% (‚Çπ42), inoperative par 5% (‚Çπ2,119). Form 16A me dikhega.`,

  // "Form 16/16A = TDS certificate "+ how to download from site - basic note (kept)
  f16_en: `You don‚Äôt need to download it yourself. Form 16A (TDS Certificate) is emailed within 45 days after the end of every quarter. To <b>verify TDS</b> yourself ‚Üí log in to the <a href="${it}" target="_blank" rel="noopener">Income Tax Portal</a> ‚Üí Download <b>Form 26AS</b> / <b>AIS</b> showing all TDS against your PAN.<br><br>
  <u>Quick steps (26AS)</u>: Login ‚Üí e-File ‚Üí Income Tax Forms ‚Üí <i>View Form 26AS</i> ‚Üí Proceed ‚Üí Select AY ‚Üí Download.`,
  f16_hi: `‡§ñ‡•Å‡§¶ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡§§ ‡§®‡§π‡•Ä‡§Ç‚Äî‡§§‡§ø‡§Æ‡§æ‡§π‡•Ä ‡§ñ‡§§‡•ç‡§Æ ‡§π‡•ã‡§®‡•á ‡§ï‡•á 45 ‡§¶‡§ø‡§® ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ Form 16A ‡§à‡§Æ‡•á‡§≤ ‡§ï‡§∞ ‡§¶‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§ <b>TDS verify</b> ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ñ‡•Å‡§¶ <a href="${it}" target="_blank" rel="noopener">Income Tax Portal</a> ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç ‚Üí <b>Form 26AS</b> / <b>AIS</b> ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç (‡§Ü‡§™‡§ï‡•á PAN ‡§™‡§∞ ‡§∏‡§æ‡§∞‡•Ä TDS entry ‡§¶‡§ø‡§ñ‡§§‡•Ä ‡§π‡•à‡§Ç)‡•§<br><br>
  <u>‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§∏‡•ç‡§ü‡•á‡§™ (26AS)</u>: Login ‚Üí e-File ‚Üí Income Tax Forms ‚Üí <i>View Form 26AS</i> ‚Üí Proceed ‚Üí AY ‡§ö‡•Å‡§®‡•á‡§Ç ‚Üí Download.`,
  f16_hn: `Khud download nahi karna padta; quarter ke 45 din ke andar Form 16A email aa jata hai.TDS dekhna</b> ho to <a href="${it}" target="_blank" rel="noopener">Income Tax Portal</a> par login karein ‚Üí <b>Form 26AS</b> / <b>AIS</b> download karein.<br><br>
  <u>26AS Quick Steps</u>: Login ‚Üí e-File ‚Üí Income Tax Forms ‚Üí <i>View Form 26AS</i> ‚Üí Proceed ‚Üí AY select ‚Üí Download.`,

  // NEW: Exact TDS visibility Q/A (as provided by you)
  tds_vis_hi: `TDS aapko do jagah dikhai dega ‚Äì Form 16 ‚Äì jo aapke employer/ deductor ke dwara issue kiya jata hai. Income Tax Portal par Form 26AS ‚Äì jisme aapke PAN ke against saari TDS details hoti hain. üëâ Income Tax Portal link: <a href="${it}" target="_blank" rel="noopener">${it}</a>`,
  tds_vis_en: `You can see TDS at two places ‚Äì Form 16 (issued by your employer/deductor) and on the Income Tax Portal in Form 26AS (shows all TDS against your PAN). üëâ Income Tax Portal link: <a href="${it}" target="_blank" rel="noopener">${it}</a>`,
  tds_vis_hn: `TDS do jagah dikhega ‚Äì Form 16 (employer/deductor issue karta hai) aur Income Tax Portal par Form 26AS (PAN ke against sabhi TDS details). üëâ Link: <a href="${it}" target="_blank" rel="noopener">${it}</a>`,

  // NEW: Bank change/addition documents (with Company optional note)
  bank_docs_en: `<b>Bank Change / Addition ‚Äì Required documents</b><br>
  ‚Ä¢ <b>Bank Statement</b> or <b>Passbook</b> or <b>Cancelled Cheque</b> (any one)<br>
  ‚Ä¢ <b>Bank Profile Page</b> with PAN & Account No. (<i>mandatory for Individuals/Partnerships; optional for Pvt Ltd/Ltd Companies</i>)<br>
  ‚Ä¢ <b>PAN Card Copy</b> matching the PAN registered with WIOM`,
  bank_docs_hi: `<b>Bank Change / Addition ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º</b><br>
  ‚Ä¢ <b>Bank Statement</b> / <b>Passbook</b> / <b>Cancel Cheque</b> (‡§á‡§®‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡•ã‡§à ‡§è‡§ï)<br>
  ‚Ä¢ <b>Bank Profile Page</b> ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç PAN ‡§î‡§∞ Account No. ‡§π‡•ã (<i>Individual/Partnership ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø; Company (Pvt Ltd/Ltd) ‡§ï‡•á ‡§≤‡§ø‡§è optional</i>)<br>
  ‚Ä¢ <b>PAN Card Copy</b> ‡§ú‡•ã WIOM ‡§Æ‡•á‡§Ç registered PAN ‡§∏‡•á match ‡§ï‡§∞‡§§‡•Ä ‡§π‡•ã`,
  bank_docs_hn: `<b>Bank Change / Addition ke docs</b><br>
  ‚Ä¢ Bank Statement / Passbook / Cancel Cheque (koi ek)<br>
  ‚Ä¢ Bank Profile Page with PAN & A/c No. (<i>Individual/Partnership ke liye mandatory; Company (Pvt Ltd/Ltd) ke liye optional</i>)<br>
  ‚Ä¢ PAN Card Copy jo WIOM me registered PAN se match karti ho`,

  // Validation links keep
  val_en: `Validate PAN‚ÄìAadhaar on the <a href="${it_link_status}" target="_blank" rel="noopener">Income Tax Portal (Link Aadhaar Status)</a> and GSTIN on the <a href="${gst}" target="_blank" rel="noopener">GST Portal (Search by PAN)</a>.<br><br>
  If PAN is non-operative ‚Üí higher TDS (5%) applies. If GSTIN is inactive ‚Üí you cannot charge GST on bills.`,
  val_hi: `<a href="${it_link_status}" target="_blank" rel="noopener">Income Tax Portal ‚Üí Link Aadhaar Status</a> ‡§™‡§∞ PAN‚ÄìAadhaar ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ <a href="${gst}" target="_blank" rel="noopener">GST Portal ‚Üí Search by PAN</a> ‡§™‡§∞ GSTIN status ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§<br><br>
  PAN non-operative ‡§π‡•Å‡§Ü ‡§§‡•ã 5% TDS; GSTIN inactive ‡§π‡•Å‡§Ü ‡§§‡•ã GST ‡§ö‡§æ‡§∞‡•ç‡§ú ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á‡•§`,
  val_hn: `<a href="${it_link_status}" target="_blank" rel="noopener">IT portal</a> par PAN‚ÄìAadhaar status aur <a href="${gst}" target="_blank" rel="noopener">GST portal</a> par GSTIN status check karein. PAN non-operative ‚Üí 5% TDS; GSTIN inactive ‚Üí GST charge nahi.`,

  rate_en: `GST on internet services is <b>18%</b>.`,
  rate_hi: `‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§™‡§∞ GST <b>18%</b> ‡§π‡•à‡•§`,
  rate_hn: `Internet services par GST <b>18%</b> hota hai.`,

  inv_en: `<b>Who should issue GST invoice?</b><br>
  For e-commerce business covered under 194O, WIOM deducts <b>TCS 0.5%</b> of taxable income.<br><br>
  ‚Ä¢ WIOM issues invoice for WIOM share only.<br>
  ‚Ä¢ Partner (LCO) issues invoice to the customer for <b>partner share only</b>.<br><br>
  <b>Example</b>: Customer recharge ‚Çπ575 ‚Üí WIOM share ‚Çπ200 ‚Üí WIOM issues ‚Çπ200 invoice; Partner share ‚Çπ375 ‚Üí Partner issues <b>‚Çπ375 invoice to customer</b>.`,
  inv_hi: `<b>GST ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§ï‡§ø‡§∏‡•á ‡§ú‡§æ‡§∞‡•Ä ‡§ï‡§∞‡§®‡•Ä ‡§π‡•à?</b><br>
  194O ‡§ï‡•á ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ e-commerce ‡§™‡§∞ WIOM <b>TCS 0.5%</b> deduct ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§<br><br>
  ‚Ä¢ WIOM ‡§Ö‡§™‡§®‡•á ‡§π‡§ø‡§∏‡•ç‡§∏‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§<br>
  ‚Ä¢ ‡§™‡§æ‡§∞‡•ç‡§ü‡§®‡§∞ (LCO) ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•ã ‡§ï‡•á‡§µ‡§≤ <b>‡§Ö‡§™‡§®‡•á ‡§π‡§ø‡§∏‡•ç‡§∏‡•á</b> ‡§ï‡•Ä ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§ï‡§∞‡•á‡§ó‡§æ‡•§<br><br>
  <b>‡§â‡§¶‡§æ‡§π‡§∞‡§£</b>: ‡§∞‡§ø‡§ö‡§æ‡§∞‡•ç‡§ú ‚Çπ575 ‚Üí WIOM ‚Çπ200 ‡§ï‡•Ä ‡§á‡§®‡§µ‡•â‡§á‡§∏; ‡§™‡§æ‡§∞‡•ç‡§ü‡§®‡§∞ ‡§∂‡•á‡§Ø‡§∞ ‚Çπ375 ‚Üí ‡§™‡§æ‡§∞‡•ç‡§ü‡§®‡§∞ <b>‚Çπ375 ‡§ï‡•Ä ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•ã</b> ‡§ú‡§æ‡§∞‡•Ä ‡§ï‡§∞‡•á‡§ó‡§æ‡•§`,
  inv_hn: `<b>Invoice kisko issue karni hai?</b><br>
  194O cover me WIOM <b>TCS 0.5%</b> deduct karta hai.<br><br>
  ‚Ä¢ WIOM apne share ki invoice karta hai.<br>
  ‚Ä¢ Partner (LCO) customer ko <b>sirf apne share</b> ki invoice karega.<br><br>
  <b>Example</b>: Recharge ‚Çπ575 ‚Üí WIOM ‚Çπ200 invoice; Partner share ‚Çπ375 ‚Üí Partner <b>‚Çπ375 ki invoice</b> customer ko dega.`
};

const FAQ = [
  {key:'tds',  q:{en:'TDS section & rate on WIOM payouts', hi:'WIOM payout ‡§™‡§∞ TDS ‡§∏‡•á‡§ï‡•ç‡§∂‡§® ‡§î‡§∞ ‡§∞‡•á‡§ü', hn:'WIOM payout par TDS section & rate'}, a:{en:A.tds_en, hi:A.tds_hi, hn:A.tds_hn}},
  {key:'f16',  q:{en:'Form 16A download (basic info)', hi:'Form 16A ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° (‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø)', hn:'Form 16A download info'}, a:{en:A.f16_en, hi:A.f16_hi, hn:A.f16_hn}},
  // NEW Bank change/addition docs entry
  {key:'bankdocs', q:{en:'Docs for Bank Change / Addition', hi:'Bank Change / Addition ‡§ï‡•á ‡§≤‡§ø‡§è Documents', hn:'Bank change/addition ke docs'}, a:{en:A.bank_docs_en, hi:A.bank_docs_hi, hn:A.bank_docs_hn}},

  {key:'val',  q:{en:'Validate PAN/GSTIN', hi:'PAN/GSTIN ‡§µ‡•à‡§≤‡§ø‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç', hn:'PAN/GSTIN validate kaise karein'}, a:{en:A.val_en, hi:A.val_hi, hn:A.val_hn}},
  {key:'rate', q:{en:'GST rate on internet service and related charges', hi:'‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§∏‡•á‡§µ‡§æ ‡§î‡§∞ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§™‡§∞ GST ‡§∞‡•á‡§ü', hn:'Internet service par GST rate'}, a:{en:A.rate_en, hi:A.rate_hi, hn:A.rate_hn}},
  {key:'inv',  q:{en:'GST invoice issues to whom', hi:'GST ‡§á‡§®‡§µ‡•â‡§á‡§∏ ‡§ï‡§ø‡§∏‡•á ‡§ú‡§æ‡§∞‡•Ä ‡§π‡•ã‡§ó‡•Ä', hn:'GST invoice kisko issue hoti hai'}, a:{en:A.inv_en, hi:A.inv_hi, hn:A.inv_hn}},
];

function detectIntent(text){
  const s = (text||'').toLowerCase();
  // existing checks
  if (/(invoice|‡§á‡§®‡§µ‡•â‡§á‡§∏|bill)\s*(kaise|kese|kais[e]?)?/.test(s) ||
      /(kisko|kis ko|whom).*(invoice|bill)/.test(s) ||
      /(invoice|bill).*(kisko|kis ko|whom|issue)/.test(s)) return 'inv';
  if (/(tds|194o|deduct|‡§ï‡§ü|‡§ï‡§ü‡•å‡§§‡•Ä)/.test(s)) return 'tds';
  if (/(16a|tds certificate|certificate|form\s*16)/.test(s)){
    return 'f16';
  }
  if (/(validate|status|pan|aadhaar|aadhar|gstin|link)/.test(s)) return 'val';
  if (/(gst).*(rate|percent|percentage|18|‡§∞‡•á‡§ü)/.test(s) || /(internet|broadband).*(gst)/.test(s)) return 'rate';
  // NEW intents
if (/(bank).*(change|addition|add|update|badal|jod)/.test(s)) return 'bankdocs';
  return null;
}

let lang='en';
const $=id=>document.getElementById(id);
function add(role,html){const d=document.createElement('div');d.className='msg '+(role==='user'?'user':'bot');d.innerHTML=`<div class='bub'>${html}</div>`;$('m').appendChild(d);$('m').scrollTop=$('m').scrollHeight;}
function chips(){const wrap=document.createElement('div');wrap.className='sug';FAQ.forEach(item=>{const c=document.createElement('div');c.className='chip';c.textContent=item.q[lang];c.onclick=()=>{ $('t').value=item.q[lang]; send();};wrap.appendChild(c);});$('m').appendChild(wrap);} 
function greet(){add('bot', lang==='hi'?'‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Ø‡§π‡§æ‡§Å TDS, Form 16/16A, PAN/GST, GST rate ‡§î‡§∞ Invoice ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§∏‡§µ‡§æ‡§≤ ‡§™‡•Ç‡§õ‡•á‡§Ç‡•§':'hn'===lang?'Namaste! Yahan TDS, Form 16/16A, PAN/GST, GST rate aur invoice related sawaal poochiye.':'Hi! Ask about TDS, Form 16/16A, PAN/GST validation, GST rate, or who should invoice.'); chips();}
function answerByKey(key){const item = FAQ.find(x=>x.key===key); return item ? item.a[lang] : null;}
function findExact(q){return FAQ.find(x=>Object.values(x.q).some(v=>v.toLowerCase()===q.toLowerCase()));}

function send(){
  const q = $('t').value.trim(); if(!q) return;
  add('user', q); $('t').value='';
  const k = detectIntent(q);
  if (k){ add('bot', answerByKey(k)); return; }
  const ex = findExact(q); if (ex){ add('bot', ex.a[lang]); return; }
  const s = q.toLowerCase().split(/\W+/).filter(Boolean);
  let best={score:0, item:null};
  for (const item of FAQ){
    const hay = (item.q.en+' '+item.q.hi+' '+item.q.hn+' '+item.a.en).toLowerCase();
    let sc=0; for (const tok of s){ if (hay.includes(tok)) sc++; }
    if (sc>best.score){ best={score:sc,item}; }
  }
  if (best.item && best.score>0){ add('bot', best.item.a[lang]); return; }
  add('bot', lang==='hi'?'‡§Æ‡§æ‡§´‡§º ‡§ï‡•Ä‡§ú‡§ø‡§è, ‡§∏‡§Æ‡§ù ‡§®‡§π‡•Ä‡§Ç ‡§™‡§æ‡§Ø‡§æ‡•§ ‡§ä‡§™‡§∞ ‡§¶‡§ø‡§è ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ö‡•Å‡§®‡•á‡§Ç ‡§Ø‡§æ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§™‡•Ç‡§õ‡•á‡§Ç‡•§':'hn'===lang?'Sorry, samajh nahi aaya ‚Äî upar ke options me se choose karen ya phir se poochein.':'Sorry, I didn‚Äôt get that. Pick a chip above or try again.');
}

$('b').onclick=()=>{const w=$('w');w.style.display=w.style.display?'':'flex'; if(w.style.display){$('m').innerHTML=''; greet();}};
$('x').onclick=()=>{$('w').style.display='none'};
$('s').onclick=send; $('t').addEventListener('keydown',e=>{if(e.key==='Enter')send()});
$('lang').onchange=e=>{lang=e.target.value; $('m').innerHTML=''; greet();};
</script>

<!-- Ticket runtime injection (keeps original chips) -->
<style>
.ticket-form{border:1px solid #e5e7eb;background:#fff;border-radius:12px;padding:12px;margin:8px 0}
.ticket-form h4{margin:0 0 8px 0}
.ticket-form label{display:block;font-size:12px;margin-top:8px}
.ticket-form input,.ticket-form textarea{width:100%;padding:8px;border:1px solid #ddd;border-radius:8px;margin-top:4px}
.ticket-form button{margin-top:10px;background:#16a34a;color:#fff;border:none;border-radius:8px;padding:8px 12px;cursor:pointer}
.ticket-kudos{font-size:13px;margin-top:6px}
</style>
<script>(function(){
 try{
   A.SHEET_WEBAPP_URL = A.SHEET_WEBAPP_URL || 'https://script.google.com/macros/s/AKfycbwUWx1xYd_KrmS9vJ0ymf1aFmUcLq1Pi-J9_AMRQzUgauRu-MthZQgoZQVh3DK7oFr-/exec';
   A.ticket_en = {chip:'For any other concerns',form_title:'Raise a ticket & request callback',name:'Partner Name',email:'Email',phone:'Phone Number',issue:'Describe your issue',submit:'Submit Ticket',ok:'Your ticket has been raised. Our team will call back within 48 hours.',fail:'Ticket saved locally. Network error prevented server logging.'};
   A.ticket_hi = {chip:'For any other concerns',form_title:'‡§ü‡§ø‡§ï‡§ü ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§ï‡•â‡§≤-‡§¨‡•à‡§ï ‡§Æ‡§æ‡§Ç‡§ó‡•á',name:'‡§™‡§æ‡§∞‡•ç‡§ü‡§®‡§∞ ‡§®‡§æ‡§Æ',email:'‡§à‡§Æ‡•á‡§≤',phone:'‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞',issue:'‡§Ö‡§™‡§®‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§¨‡§§‡§æ‡§è‡§Ç',submit:'‡§ü‡§ø‡§ï‡§ü ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç',ok:'‡§Ü‡§™‡§ï‡§æ ‡§ü‡§ø‡§ï‡§ü ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ü‡•Ä‡§Æ 48 ‡§ò‡§Ç‡§ü‡•ã‡§Ç ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§ó‡•Ä‡•§',fail:'‡§ü‡§ø‡§ï‡§ü ‡§≤‡•ã‡§ï‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡•á‡§µ ‡§π‡•Å‡§Ü; ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§∞ ‡§≠‡•á‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ï‡•ç‡§ï‡§§ ‡§Ü‡§à‡•§'};
   A.ticket_hn = {chip:'For any other concerns',form_title:'Ticket raise karein & callback mangayein',name:'Partner Name',email:'Email',phone:'Phone Number',issue:'Issue bataiye',submit:'Submit Ticket',ok:'Ticket raise ho gaya. Team 48 ghante me call karegi.',fail:'Ticket local me save hua, server par bhejne me error.'};
 }catch(e){}
 function _lang(){ try{ return document.getElementById('lang')?.value || 'en'; }catch(_){ return 'en'; } }
 function _L(){ const l=_lang(); return l==='hi'?A.ticket_hi:(l==='hn'?A.ticket_hn:A.ticket_en); }
 function formHTML(){ const d=_L(); return `<div class="ticket-form"><h4>${d.form_title}</h4><label>${d.name}<input data-wiom="name" placeholder="${d.name}"></label><label>${d.email}<input type="email" data-wiom="email" placeholder="${d.email}"></label><label>${d.phone}<input type="tel" data-wiom="phone" placeholder="${d.phone}"></label><label>${d.issue}<textarea rows="3" data-wiom="issue" placeholder="${d.issue}"></textarea></label><button onclick="wiomSubmitTicket(this)">${d.submit}</button><div class="ticket-kudos"></div></div>`; }
 window.wiomSubmitTicket = async function(btn){
   const f=btn.closest('.ticket-form'), d=_L();
   const name=f.querySelector('[data-wiom="name"]').value.trim();
   const email=f.querySelector('[data-wiom="email"]').value.trim();
   const phone=f.querySelector('[data-wiom="phone"]').value.trim();
   const issue=f.querySelector('[data-wiom="issue"]').value.trim();
   if(!name||!email||!phone||!issue){ f.querySelector('.ticket-kudos').textContent='Please fill all fields.'; return; }
   const id='WIOM-'+(Date.now().toString().slice(-6));
   const ticket={id,partnerName:name,email,phone,issue,status:'Pending Callback',ts:new Date().toISOString()};
   try{ const k='wiom_tickets'; const arr=JSON.parse(localStorage.getItem(k)||'[]'); arr.push(ticket); localStorage.setItem(k, JSON.stringify(arr)); }catch(e){}
   let ok=false; try{ if(A.SHEET_WEBAPP_URL){ const body='payload='+encodeURIComponent(JSON.stringify(ticket)); const r=await fetch(A.SHEET_WEBAPP_URL,{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8'},body}); ok=!!r.ok; } }catch(_){ ok=false; }
   try{ add('bot', `${d.ok}<br><br><b>Ticket:</b> ${id}<br><b>Name:</b> ${name}<br><b>Email:</b> ${email}<br><b>Phone:</b> ${phone}`); }catch(_){ f.querySelector('.ticket-kudos').innerHTML=`${d.ok} (Ticket: ${id})`; }
   if(!ok){ try{ add('bot', d.fail); }catch(_){ } }
 };
 try{
   FAQ.unshift({key:'raise_concern', q:{en:A.ticket_en.chip, hi:A.ticket_hi.chip, hn:A.ticket_hn.chip}, a:{en:formHTML(), hi:formHTML(), hn:formHTML()}});
 }catch(e){}
 try{
   const _detect=detectIntent;
   window.detectIntent=function(text){ const k=_detect? _detect(text):null; if(k) return k; const s=(text||'').toLowerCase(); if(/(raise|callback|call\s*back|concern|issue|ticket)/.test(s)) return 'raise_concern'; return null; };
 }catch(e){}
})();</script>

</body></html>
